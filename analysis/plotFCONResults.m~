%function [theResult] = plotFCONResults(mergedPacketCellArray)

effectiveContrast_sessxrunxevent = load('~/Dropbox-Aguirre-Brainard-Lab/MELA_analysis/pupilMelanopsinMRIAnalysis/fitFCONModelToIndividualResponses/effectiveContrast_sessxrunxevent.mat');
myResultsVariable = effectiveContrast_sessxrunxevent.myResultsVariable;
contrastList = ['25%' '50%' '100%' '200%' '400%']

for ss = 1:size(mergedPacketCellArray,2); % loop over subjects
     
    for contrast = 1:6;
        fcon{ss,contrast}=[];
        fcon_log{ss,contrast}=[];
    end
end

for ss = 1:size(mergedPacketCellArray,2); % loop over subjects
     
    for rr = 1:size(mergedPacketCellArray{ss},2); % loop over runs
        for ii = 1:size(mergedPacketCellArray{ss}{rr}.stimulus.values,1); % loop over instances
            contrast = mergedPacketCellArray{ss}{rr}.stimulus.metaData.stimTypes(ii);
            fcon_log{ss,contrast} = [fcon_log{ss,contrast} myResultsVariable(ss,rr,ii)];
            fcon{ss,contrast} = [fcon{ss,contrast} 10^(myResultsVariable(ss,rr,ii))*100];
        end
    end
end



fconMean =zeros(8,6)
fconSEM = zeros(8,6)
for ss = 1:size(mergedPacketCellArray,2); % loop over subjects
    
    for contrast = 1:6;
        fconMean(ss,contrast) = mean(fcon{ss,contrast})
        fconSEM(ss,contrast) = std(fcon{ss,contrast})/sqrt(length(fcon{ss,contrast}))
    end
end

    
plotFig = figure;
hold on
set(gca,'Xtick',[25 50 100 200 400],'XTickLabel',{'25%', '50%', '100%', '200%', '400%'})
ylim([0 500])
xlim([0 450])
xlabel('Administered Contrast')
ylabel('Effective Contrast')   

for ss = 1:size(mergedPacketCellArray,2);

plot([25 50 100 200 400],fconMean(ss,1:5), 'o')

h=errorbar([25 50 100 200 400],fconMean(ss,1:5),fconSEM(ss,1:5),'c'); set(h,'linestyle','none')

 





% do each session separately
% plot mean and SEM across contrast level